# Claude Code 配置管理工具生成提示方案

## 目标概述
- 提供一个图形化桌面工具，帮助用户集中管理 Claude Code 的运行配置。
- 使用户能够维护多套环境变量脚本，并在需要时快速写入 Claude Code 的设置文件。
- 支持在应用内一键启动 Claude Code，确保所选配置即时生效。

## 关键使用场景
1. **浏览与选择配置**：应用启动后展示现有配置列表，用户可以双击或选中条目查看详情。
2. **创建或修改配置**：用户可新增、编辑、删除包含 PowerShell 环境变量命令的文本片段，并保存到本地持久化存储。
3. **同步到 Claude Code 设置**：在界面中选择 Claude Code 的设置文件路径后，用户可一键将当前配置写入设置文件中的环境变量区域，必要时可重置为默认状态。
4. **快速启动 Claude Code**：在确认工作目录后，通过按钮直接打开带有预设环境变量的 PowerShell，并执行启动 Claude Code 的命令。

## 功能模块描述
### 配置管理
- 维护一个本地的配置集合，每项包含用户可读的名称与对应的 PowerShell 命令块。
- 允许用户以表单方式编辑命令块内容，保存时自动覆盖或追加到本地集合。
- 删除操作需弹出确认提示，以防误删。

### 设置写入与重置
- 解析 PowerShell 命令块中的环境变量赋值语句，抽取键值对。
- 将解析结果写入 Claude Code 设置文件的环境变量节点，必要时创建该节点。
- 提供重置按钮，将环境变量节点清空或恢复为空结构。

### 工作目录与启动流程
- 允许用户选择本地工作目录，并持久化记忆该路径，应用重启后自动还原。
- 在启动 Claude Code 前，先切换到该工作目录，继而注入所选配置的环境变量，并执行启动命令。
- 提供直接启动（忽略配置）与按照配置启动两种方式，均应在 PowerShell 窗口中运行。

### 用户界面交互
- 主界面采用左右分栏：左侧展示配置列表，右侧用于编辑与说明。
- 底部区域提供保存、删除、写入设置、重置、启动等操作按钮，并显示当前设置文件与工作目录状态。
- 对于关键操作（保存成功、写入失败等）提供弹窗或状态提示，使用中文文案。

## 数据与文件约束
- 本地配置持久化使用 JSON 结构，字段包含配置名称与命令文本。
- Claude Code 设置文件中需存在可写的环境变量区域，工具应在写入前读取并在写入后重新保存。
- 为便于测试，准备一份示例设置文件与默认配置集合，可在首次运行时自动生成。

## 生成实现建议
1. **数据层**：实现对本地配置集合的读取、写入与删除操作，保证写入时保持良好的缩进格式。
2. **解析层**：编写解析逻辑，将 PowerShell 中形如 `$Env:变量="值"` 的语句转换为键值对集合，忽略空行与注释。
3. **设置同步层**：完成对 Claude Code 设置文件的加载、写入与重置逻辑，确保错误时给出友好提示。
4. **UI 层**：构建双列界面并绑定事件，确保按钮操作对应业务逻辑，超链接点击时可打开外部资源或文件夹。
5. **启动流程**：封装启动 Claude Code 的命令拼接流程，在 PowerShell 中执行并保持窗口打开。

## 验收清单
- [ ] 应用启动后能展示配置列表，编辑区内容与选中项实时同步。
- [ ] 新增或修改配置后，本地持久化文件立即更新，并可刷新界面看到最新内容。
- [ ] 选择设置文件后，写入环境变量按钮能正确更新该文件，重置按钮能清空环境变量区域。
- [ ] 按照配置启动 Claude Code 时，会先切换到指定目录，再执行环境变量注入与启动命令。
- [ ] 应用重启后，仍能记住上次选择的工作目录。

> 按照以上提示方案生成代码，可在不同工具中保持功能一致，并留有空间根据具体平台调整实现细节。
